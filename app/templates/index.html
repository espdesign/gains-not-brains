<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Barbell Weight Calculator</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; margin: 2rem; background-color: #f4f4f4; }
        .container { max-width: 900px; margin: auto; background-color: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        h1, h2 { color: #333; }
        p { color: #666; }
        
        form { margin-top: 2rem; display: flex; gap: 1rem; align-items: center; }
        input[type="number"] { padding: 0.75rem; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; }
        button { padding: 0.75rem 1.5rem; background-color: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; transition: background-color 0.2s; }
        button:hover { background-color: #0056b3; }
        .error { color: #dc3545; margin-top: 1rem; font-weight: bold; }
        .info { background-color: #e9ecef; padding: 1rem; border-radius: 4px; margin-top: 1rem; font-family: monospace; }
        
        .barbell-container {
            display: flex;
            align-items: center;
            margin-top: 2rem;
        }
        .barbell-end {
            height: 15px;
            background-color: #444;
            width: 40px;
            margin-right: -2px;
        }
        .barbell-shaft {
            height: 10px;
            background-color: #666;
            width: 300px;
        }
        .plates-container { 
            display: flex; 
            align-items: center; 
            gap: 5px; 
            margin-left: -5px; 
        }
        .plate { 
            height: 120px; 
            border-radius: 10px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 1.5em; 
            font-weight: bold;
            color: white; 
            border: 2px solid #333;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            padding: 0 5px;
        }

        /* Plate Colors and Widths - Updated to handle both int and float classes */
        .plate-45, .plate-45_0 { background-color: #B22222; width: 60px; }
        .plate-35, .plate-35_0 { background-color: #0000CD; width: 55px; }
        .plate-25, .plate-25_0 { background-color: #FF4500; width: 50px; }
        .plate-15, .plate-15_0 { background-color: #DAA520; width: 45px; }
        .plate-10, .plate-10_0 { background-color: #228B22; width: 40px; }
        .plate-5, .plate-5_0 { background-color: #000000; width: 35px; }
        .plate-2_5 { background-color: #696969; width: 30px; }
        
        .plan-list { list-style: none; padding: 0; }
        .plan-list li { margin-bottom: 0.5rem; color: #333; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Barbell Weight Calculator</h1>
        <p>Enter a target weight to see how to load the barbell. The barbell itself weighs 45 lbs.</p>

        <form method="POST">
            <label for="target_weight">Target Weight (lbs):</label>
            <input type="number" id="target_weight" name="target_weight" step="any" required>
            <button type="submit">Calculate</button>
        </form>

        {% if error %}
            <p class="error">{{ error }}</p>
        {% endif %}

        <h2>Current Barbell: {{ barbell.current_load() }} lbs</h2>
        <div class="barbell-container">
            <div class="barbell-shaft"></div>
            <div class="barbell-end"></div>
            <div class="plates-container">
                {% for plate_weight in barbell.cur_plate_order %}
                    <div class="plate plate-{{ plate_weight|string|replace('.', '_') }}">
                        {% if plate_weight == 2.5 %}
                            {{ plate_weight }}
                        {% else %}
                            {{ plate_weight|int }}
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        </div>

        <div class="info">
            <h3>Gym Plate Supply:</h3>
            <pre>{{ gym.plates }}</pre>
        </div>

        {% if gym.plan %}
            <div class="info">
                <h3>Plan to reach target:</h3>
                <ul class="plan-list">
                {% for step in gym.plan %}
                    {% for action, plates in step %}
                        <li>
                            {% if action == 'ADD' %}
                                ADD: {{ plates|join(', ') }} lbs plate(s)
                            {% elif action == 'REMOVE' %}
                                REMOVE: {{ plates|join(', ') }} lbs plate(s)
                            {% endif %}
                        </li>
                    {% endfor %}
                {% endfor %}
                </ul>
            </div>
        {% endif %}

    </div>
</body>
</html>